###### 비개발자를 위한 MySQL
# 내부 조인

MySQL은 관계형 데이터베이스이기 때문에 데이터가 여러 테이블로 나뉘어서 나타납니다. 그렇기 때문에 각각의 테이블을 연계해서 보여줄 필요가 있습니다. 이럴때 사용하는 것이 **내부 조인** 입니다.

## `INNER JOIN`
내부 조인을 사용하기 위한 문법은 `INNER JOIN`입니다. `INNER JOIN`은 테이블과 테이블을 연결하여 테이블 사이의 교집합을 구하는 역활을 합니다.

<p align="center">
  <img src="https://github.com/kciter/MySQLForNonDeveloper/blob/master/Images/inner_join.gif?raw=true"><br>
  <sub><code>INNER JOIN</code>은 테이블 사이의 교집합을 구해준다</sub>
</p>

앞에서 `SUBQUERY`를 배울 때 두 테이블을 연관시켜 출력시켰던 것을 기억하시나요? 그것과 일치하는 작업을 할 수 있습니다. 성능도 `INNER JOIN`이 더 빠릅니다.

다음 테이블을 봅시다.

<sub>주문 테이블</sub>

|id |손님 이름|메뉴이름|가격 |
|---|---------|--------|-----|
|1  |이선협   |돼지고기|11000|
|2  |김려은   |육회    |9900 |
|3  |김지환   |연어회  |16000|
|4  |이선협   |소고기  |31000|


지금까지는 위와 같이 테이블이 표현되었습니다. 하지만 원래대로라면 다음과 같이 테이블을 만드는 것이 정상입니다.

<sub>주문 테이블</sub>

|id |손님id|메뉴id|손님이름|메뉴이름|가격 |
|---|------|------|--------|--------|-----|
|1  |12    |11    |이선협  |돼지고기|11000|
|2  |7     |25    |김려은  |육회    |9900 |
|3  |45    |81    |김지환  |연어회  |16000|
|4  |12    |91    |이선협   |소고기  |31000|

<sub>손님 테이블</sub>

|id |손님이름|키   |소지금|
|---|--------|-----|------|
|12 |이선협  |175cm|35000 |
|7  |김려은  |162cm|89900 |
|45 |김지환  |175cm|18000 |

<sub>메뉴 테이블</sub>

|id |메뉴이름|가격  |원산지|
|---|--------|------|------|
|11 |돼지고기|11000 |국내산|
|25 |육회    |9900  |국내산|
|81 |연어회  |16000 |칠레산|
|91 |소고기  |31000 |국내산|

주문 테이블에 `손님id`와 `메뉴id`가 생겼습니다. 그리고 각각 손님 테이블과 메뉴 테이블의 id와 일치합니다. 관계형 데이터베이스인 MySQL에서는 이런 방식으로 테이블과 테이블 사이의 관계를 이어줄 수 있습니다. 여기서 `손님id`와 `메뉴id`와 같은 컬럼을 **외래키**라고 합니다.

만약 여기서 손님들의 주문 내역과 동시에 해당 손님에 대한 정보를 가져오고 싶다면 어떻게 해야할까요? 아까 `INNER JOIN`은 테이블과 테이블 사이 교집합을 구하는 역할을 한다고 했습니다. `INNER JOIN`을 사용하면 주문 테이블과 손님 테이블을 연결시킬 수 있습니다.

```sql
SELECT # 여러 라인으로 SQL을 작성할 수도 있습니다.
  customers.name,
  customers.tall,
  orders.menu_name, 
  orders.price
FROM orders
INNER JOIN customers
ON orders.customers_id = customers.id;
```

사용법은 간단합니다. `FROM` 이후에 `INNER JOIN table_name`을 입력하면 됩니다. 그런데 여기서 못보던 키워드가 있습니다. 바로 `ON`입니다. `ON`은 `WHERE`, `HAVING`과 같은 조건절 문법입니다. 위 쿼리 처럼 `ON`은 테이블과 테이블 사이를 이어주는 조건을 입력하게 됩니다.

<sub>주문 테이블과 손님 테이블의 내부 조인 결과</sub>

|손님이름|키 |메뉴이름|가격 |
|--------|---|--------|-----|
|이선협  |175|돼지고기|11000|
|김려은  |162|육회    |9900 |
|김지환  |155|연어회  |16000|
|이선협  |175|소고기  |31000|

결과적으로 손님의 정보와 주문의 정보를 동시에 얻을 수 있습니다. 위 쿼리는 다음과 줄여서 사용할 수 있습니다.

```sql
SELECT # 귀찮으니 AS를 적극적으로 사용합시다!!
  c.name,
  c.tall,
  o.menu_name, 
  o.price
FROM orders as o
INNER JOIN customers as c
ON o.customers_id = c.id;
```

## 과제

|손님이름|키 |메뉴이름|가격 |
|--------|---|--------|-----|
|이선협  |175|돼지고기|11000|
|김려은  |162|육회    |9900 |
|김지환  |155|연어회  |16000|
|이선협  |175|소고기  |31000|

아까 본 이 결과에서 `이선협`을 합쳐서 보여주려면 어떻게 해야할까요? 손님이름, 키, 메뉴이름, 가격과 동시에 각 손님이 주문한 횟수를 구하려면 어떻게 해야할까요?

> 힌트: GROUP BY, count

## 마치며
이번 장에서는 내부 조인에 대해서 배웠습니다. 다음 장에서는 테이블 간의 **합집합**을 구하는 [외부 조인](OUTER-JOIN.md)에 대해서 배워보겠습니다.

## 사진 출처
* [W3School](http://w3schools.com/sql/)

## 지적, 수정사항에 대해서
Github 계정이 있으신 분들은 Issue에 지적사항을 등록해주시거나 직접 수정하여 Pull request를 주시면 반영하도록 하겠습니다. <br>Github 계정이 없으신 분들은 kciter@naver.com를 통해 지적사항을 보내주세요. :smile:

## 라이센스
<a rel="license" href="http://creativecommons.org/publicdomain/mark/1.0/">
<img src="https://licensebuttons.net/p/mark/1.0/88x31.png" alt="Public Domain Mark" />
</a>

이 문서는 [CC0 라이센스](LICENSE)를 따릅니다.

특허권 또는 상표권은 CC0에 의해 영향을 받지 않으며, 퍼블리시티권 및 프라이버시권 등 저작물 자체에 대해 또는 저작물 이용에 대해 타인이 갖는 권리 또한 영향을 받지 않습니다.

달리 정하지 않은 한, 본 저작물의 인증자는 관련법에서 허용하는 최대 한도 내에서 저작물에 대해 아무런 보증도 하지 않으며 저작물의 모든 이용에 관한 어떠한 책임도 지지 않습니다.

저작물을 사용하거나 인용할 때 저자나 인증자로부터 승인을 받았다는 뜻을 시사하여서는 안됩니다.
